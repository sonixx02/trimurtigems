fontdetect=function(){function n(){if(e){return}e=true;$("body > :first-child").before('<div id="fontdetectHelper"><span>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ</span></div>');$("#fontdetectHelper").css({position:"absolute",visibility:"hidden",top:"-200px",left:"-100000px",width:"100000px",height:"200px","font-size":"100px"})}var e=false;var t=["serif","sans-serif","monospace","cursive","fantasy"];return{onFontLoaded:function(t,r,i,s){if(!t){return}var o=s&&s.msInterval?s.msInterval:100;var u=s&&s.msTimeout?s.msTimeout:2e3;if(!r&&!i){return}if(!e){n()}if(s&&s.testString){$("#fontdetectHelper > SPAN").text(s.testString)}else{$("#fontdetectHelper > SPAN").text("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")}if(this.isFontLoaded(t)){if(r){r(t)}return}var a=this;var f=(new Date).getTime();var l=setInterval(function(){if(a.isFontLoaded(t)){clearInterval(l);r(t);return}else{var e=(new Date).getTime();if(e-f>u){clearInterval(l);if(i){i(t)}}}},o)},isFontLoaded:function(r){var i=0;var s=0;if(!e){n()}for(var o=0;o<t.length;++o){var u=$("#fontdetectHelper > SPAN");u.css("font-family",r+","+t[o]);i=u.width();if(o>0&&i!=s){return false}s=i}return true},whichFont:function(e){var t=$(e).css("font-family");var n=t.split(",");var r=n.shift();while(r){r=r.replace(/^\s*['"]?\s*([^'"]*)\s*['"]?\s*$/,"$1");if(this.isFontLoaded(r)){return r}r=n.shift()}return null}}}()
