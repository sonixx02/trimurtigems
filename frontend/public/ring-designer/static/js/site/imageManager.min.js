function ImageManager(){}
ImageManager.prototype.loadImageMaterial=function(){var h={silver:{"default":"static/img/envMaps/print_imat_silver_highgloss.png",gloss:"static/img/envMaps/print_imat_silver_gloss.png",hg:"static/img/envMaps/print_imat_silver_highgloss.png",sb:"static/img/envMaps/print_imat_silver_sandblasted.png",antique:"static/img/envMaps/print_imat_silver_highgloss.png"},gold:{"default":"static/img/envMaps/print_imat_gold.png",yellow:"static/img/envMaps/print_imat_gold.png",red:"static/img/envMaps/print_imat_gold_pink.png",white:"static/img/envMaps/print_imat_gold_white.png",
yellow18:"static/img/envMaps/print_imat_gold.png",red18:"static/img/envMaps/print_imat_gold_pink.png",white18:"static/img/envMaps/print_imat_gold_white.png"},hdss:{"default":"static/img/envMaps/print_imat_steel.png"},brass:{"default":"static/img/envMaps/print_imat_brass.png",gp:"static/img/envMaps/print_imat_gold_plated.png"},bronze:{"default":"static/img/envMaps/print_imat_bronze.png"},titanium:{"default":"static/img/envMaps/print_imat_titanium.png"}},s={},t=function(f,k){var c=h[f][k];void 0===
c&&console.error("undefined material: "+f+" "+k);return window.media+"/"+c},u=function(f,k,c,b){var a,d,l,r,e,h,n=f^0;a=k^0;f-=n;k-=a;var g=n-1,m=n+1,p=n+2;e=a*b;r=e-b;h=e+b;var q=e+b+b;b=c[r+g];a=c[r+n];d=c[r+m];l=c[r+p];r=0.5*(d-b+(2*b-5*a+4*d-l+(3*(a-d)+l-b)*f)*f)*f+a;b=c[e+g];a=c[e+n];d=c[e+m];l=c[e+p];e=0.5*(d-b+(2*b-5*a+4*d-l+(3*(a-d)+l-b)*f)*f)*f+a;b=c[h+g];a=c[h+n];d=c[h+m];l=c[h+p];h=0.5*(d-b+(2*b-5*a+4*d-l+(3*(a-d)+l-b)*f)*f)*f+a;b=c[q+g];a=c[q+n];d=c[q+m];l=c[q+p];c=0.5*(d-b+(2*b-5*a+4*
d-l+(3*(a-d)+l-b)*f)*f)*f+a;b=r;a=e;d=h;l=c;return 0.5*(d-b+(2*b-5*a+4*d-l+(3*(a-d)+l-b)*k)*k)*k+a};return function(f,k,c,b){b=void 0!==h[c][b]?b:"default";var a=s[c+b],d=document.createElement("canvas");d.width=k.width;d.height=k.height;0==f.width&&console.error("normal map is width 0!");a=new Image;a.src=t(c,b);a.onload=function(){var b=document.createElement("canvas");b.width=a.width;b.height=a.height;b.getContext("2d").drawImage(a,0,0,a.width,a.height);d.getContext("2d").drawImage(f,0,0,f.width,
f.height);for(var c=d.getContext("2d").getImageData(0,0,f.width,f.height),e=b.getContext("2d").getImageData(0,0,a.width,a.height).data,b=Array(a.width*a.height),h=Array(a.width*a.height),n=Array(a.width*a.height),g=0;g<e.length;g+=4)b[g/4]=e[g],h[g/4]=e[g+1],n[g/4]=e[g+2];for(var m=0,p=e=0,q=1,g=0;g<c.data.length;g+=4)0!==c.data[g+3]&&(m=c.data[g+0]/255-0.5,e=c.data[g+1]/255-0.5,p=c.data[g+2]/255-0.5,q=Math.sqrt(m*m+e*e+p*p),m/=q,e/=q,p/=q,m=0.97*(0.5+0.5*m)*a.width,e=(1-0.97*(0.5+0.5*e))*a.height,
c.data[g+0]=u(m,e,b,a.width),c.data[g+1]=u(m,e,h,a.width),c.data[g+2]=u(m,e,n,a.width));d.getContext("2d").putImageData(c,0,0);k.addEventListener("load",function(){k.style.visibility="visible"},!1);k.src=d.toDataURL()}}}();ImageManager.prototype.loadNormalThumb=function(h){if(!$(h).data("loaded")){$(h).data("loaded",!0);var s=$(h).data("material"),t=$(h).data("finish");this.loadImageMaterial($(h)[0],$(h)[0],s,t);$(h).css("visibility","visible")}};window.imageManager=new ImageManager;
